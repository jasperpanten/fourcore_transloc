---
title: "FCG Sry Analysis in adult and embryonic tissue"
author: "L. Saunders"
date: "2023-11-08"
output: html_document
---

```{r init_}

# Import libraries ----
suppressPackageStartupMessages({
  library(dplyr)
  library(monocle3)
  library(scir)
  library(ggplot2)
  library(data.table)
  library(stringr)
  library(plotly)
  library(ggrepel)
  library(DESeq2)
  library(purrr)
  
# Source color palette.
source("../R/theme_color_palette.R")})
source("../R/differential_gene_test_functions.R")

```

We see Sry expression in our adult tissues but it's unclear how these levels relate to embryonic expression.

Sry is typically expressed between E10.5-E12.5, so we will explore published, whole-embryo data from the Shendure lab to compare our data to. 
Their data is also collected with sci-RNA-seq3, it is nuclei and uses the same MeOH/DSP fixation protocol. 

## Download and preprocess the published mouse data

I downloaded dataset 14 from their GEO repository (they are in chunks and this was the biggest).
https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE228590

It is stored on the cluster here: `/omics/groups/OE0538/internal/users/l375s/shendure_mouse`

This is the preprint the data is published in: https://www.biorxiv.org/content/10.1101/2023.04.05.535726v1

```{r load_mouse_parts}

# count matrix
emb_mtx <- Matrix::readMM("/omics/groups/OE0538/internal/users/l375s/shendure_mouse/GSE228590_gene_count.run_14.mtx.gz")

# cell annotations
emb_coldata <- fread("/omics/groups/OE0538/internal/users/l375s/shendure_mouse/GSE228590_gene_annotation.csv", sep = ",")

# gene annotations

```


## Import data

```{r import_cds, eval=FALSE}
# Import all samples.
cds <- readRDS("../data/rdata/fcg_mess_filt_anno_cds.RDS")
```